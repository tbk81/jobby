<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jobby</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="combined-layout">

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-container">
          {% for category, message in messages %}
            <div class="flash-message {{ category }}">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <img src="{{ url_for('static', filename='images/jobby_logo.png') }}" alt="Dashboard Logo" class="site-logo">

    <div class="dashboard-card primary-card">
        <h2>Job Scraper</h2>

        <form action="/process_selection" method="POST">
            <label for="company">Company:</label>
            <select name="company_name" id="company" required>
                <option value="" disabled selected>-- Select a Company --</option>
                {% for company in all_companies %}
                    <option value="{{ company.name }}">{{ company.name }}</option>
                {% endfor %}
            </select>
            <button type="submit">Start Scrape</button>
        </form>
    </div>

    <div class="dashboard-card secondary-card">
        <h2>Add New Company</h2>
        <form action="/add_company" method="POST">
            <div class="form-row">
                <input type="text" name="company_name" placeholder="Company Name (e.g. Google)" required>
                <input type="url" name="company_url" placeholder="Careers URL (e.g. https://careers.google.com)" required>
            </div>
            <button type="submit" class="add-btn">Add Company to Database</button>
        </form>
    </div>

    <div class="jobs-container">
        <h2>
            {% if scraped_company %}
                Jobs Scraped from {{ scraped_company }}
            {% else %}
                Job Board (Select a company above)
            {% endif %}
        </h2>

        <div class="job-list">
            {% for job in jobs %}
                <div class="job-card">
                    <div class="job-info">
                        <h3>{{ job.title }}</h3>
                        <p class="company">{{ job.company }}</p>
                        <p class="location">{{ job.location }}</p>
                    </div>
                    <div class="job-action">
                        <a href="{{ job.url }}" target="_blank" class="apply-btn">View Job</a>
                    </div>
                </div>
            {% else %}
                <div class="job-card">
                    <p class="empty-state">No jobs to display right now. Run a scraper!</p>
                </div>
            {% endfor %}
        </div>

        {% if scraped_company %}
            <div style="text-align: center; margin-top: 20px;">
                <a href="/" style="color: #3498db; text-decoration: none; font-weight: bold;">‚Üê Clear Filter (Hide Jobs)</a>
            </div>
        {% endif %}

    </div>

</body>
</html>